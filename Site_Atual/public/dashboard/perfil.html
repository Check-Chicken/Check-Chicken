<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="shortcut icon" href="../assets/imgs/logo_galinha.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./assets\imgs\logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <title>Editar Perfil</title>


    <link rel="stylesheet" href="./../css/perfil.css">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">

    <!-- scripts do Chart.js - 2022-1 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!--FONT AWESOME-->
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>
</head>

<body>
    <nav>
        <div class="navbar">
            <div class="container nav-container">

                <div class="area_icone_tema">
                    <div class="icone_tema">

                        <button id="trocaCor" onclick="changeColor()"><img src="../assets/imgs/dia-e-noite.png"
                                alt=""></button>

                    </div>
                </div>
                <div class="menu-items">
                    <div class="logo">
                        <img src="../assets/imgs/logo_semfundo.png">
                    </div>
                    <div class="foto-usuario">

                        <p>Olá, <span id="nomeUsuario"> Usuário!</span></p>
                        <img src="../assets/imgs/mulher.png">
                        <p>Bem vindo(a) ao CheckChicken!</p>

                    </div>
                    <br>
                    <li><svg class="navIcon" viewBox="0 0 24.00 24.00" fill="none" xmlns="http://www.w3.org/2000/svg"
                            stroke="#003366">
                            <g id="SVGRepo_bgCarrier" stroke-width="003366"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"
                                stroke="#ff0000" stroke-width="0.144"></g>
                            <g id="SVGRepo_iconCarrier">
                                <path
                                    d="M16 7C16 9.2003366914 14.200336691 11 12 11C9.7900336686 11 8 9.2003366914 8 7C8 4.7900336686 9.7900336686 3 12 3C14.200336691 3 16 4.7900336686 16 7Z"
                                    stroke="003366" stroke-width="1.104" stroke-linecap="round" stroke-linejoin="round">
                                </path>
                                <path d="M12 14C8.1340033661 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z"
                                    stroke="003366" stroke-width="1.104" stroke-linecap="round" stroke-linejoin="round">
                                </path>
                            </g>
                        </svg><a href="perfil.html" style="font-weight: bold; text-decoration: underline;">Editar
                            Perfil</a>
                    </li>


                    <li>
                        <a href="dashboard.html">
                            <img src="../assets/imgs/Dash.png" >
                            Dashboard
                        </a>
                    </li>





                    <li class="sair"> <button class="botaoLogout">
                            <a href="../index.html">
                                <div class="sign">
                                    <svg viewBox="0 0 512 512">
                                        <path
                                            d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z">
                                        </path>
                                    </svg>
                                </div>
                                <div class="text">Sair</div>
                        </button>
                        </g>
                        </svg>
                        </a>
                    </li>

                </div>
            </div>
        </div>
    </nav>
    <div class="corpo_perfil">
        <div class="corpo_esquerda">
            <div class="perfil_esquerda">
                <div class="titulo_perfil"><span id="Usuario">Usuário</span></div>
                <div class="foto-usuario_perfil">
                    <br>
                    <img id="camera" src="../assets/imgs/verificado.png" alt="">
                    <img src="../assets/imgs/mulher.png">
                </div>
                <div><button class="bt_perfil">Enviar nova foto</button></div>
                <div class="caixaTexto">Envie uma nova foto de perfil. Imagens muito grandes serão redimensionadas
                    automaticamente. <br> <br> Tamanho máximo de envio é <b>1MB</b></div>
                <div class="memberSince">Membro desde: <b id="DT_CRIACAO">30/05/2024</b></div>
            </div>
        </div>
        <div class="perfil_direita">
            <div class="titulo_direita">Editar Perfil</div>

            <div class="modal_formulario" id="modal_formulario">
                <p id="validacaoEdicao">Troque apenas os campos que deseja alterar!</p> <br><br>
                <div class="form_grupo">
                    <div class="campos_form_cadastro">
                        <div class="titulos_form">Nome Completo: </div>
                        <input type="text" id="form_cadastro_nome" class="inputs_form_cadastro"
                            placeholder="Insira seu nome aqui">
                        <div id="mensagem_erro"></div>
                    </div>
                    <div class="campos_form_cadastro">
                        <div class="titulos_form">Atualizar CPF: </div>
                        <input type="text" id="form_cadastro_CPF" class="inputs_form_cadastro" placeholder="12345678910"
                            maxlength="11">
                        <div id="mensagem_erro"></div>
                    </div>

                </div>
                <div class="form_grupo">
                    <div class="campos_form_cadastro">
                        <div class="titulos_form">Atualizar Email: </div>
                        <input type="email" id="form_cadastro_email" class="inputs_form_cadastro"
                            placeholder="exemplo@gmail.com">
                        <div id="mensagem_erro"></div>
                    </div>
                </div>

                <div class="form_grupo">
                    <div class="campos_form_cadastro">
                        <div class="titulos_form">Confirme seu novo email: </div>
                        <input type="email" id="form_cadastro_email" class="inputs_form_cadastro"
                            placeholder="exemplo@gmail.com">
                        <div id="mensagem_erro"></div>
                    </div>
                </div>

                <div class="form_grupo">
                    <div class="campos_form_cadastro">
                        <div class="titulos_form">Atualizar Senha: </div>
                        <input id="form_senha" class="inputs_form_cadastro" placeholder="************">
                        <div id="mensagem_erro"></div>
                    </div>
                    <div class="campos_form_cadastro">
                        <div class="titulos_form">Confirme sua nova senha: </div>
                        <input id="form_confirmacao_senha" class="inputs_form_cadastro" placeholder="************">
                        <div id="mensagem_erro"></div>
                    </div>

                </div>
                <div class="botoes_cadastro">

                    <button class="form_button" onclick="editar()">Salvar</button>
                </div>


                <div id="div_erros_login"></div>
            </div>
        </div>







    </div>
    </div>



</body>

</html>
<script>
    nomeUsuario.innerHTML = sessionStorage.NOME_USUARIO
    Usuario.innerHTML = sessionStorage.NOME_USUARIO
    DT_CRIACAO.innerHTML = sessionStorage.DT_CRIACAO
    idUsuario = sessionStorage.ID_USUARIO

    function editar() {
        let novoNome = form_cadastro_nome.value;


        fetch(`/perfil/editar/${sessionStorage.getItem("NOME_USUARIO")}`, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                novoNome: form_cadastro_nome.value,
                idUsuario: idUsuario,



            })
        }).then(function (resposta) {

            if (resposta.ok) {
                sessionStorage.setItem('NOME_USUARIO', novoNome);
                window.alert("Nome atualizado com sucesso para: " + sessionStorage.getItem("NOME_USUARIO") + "!");
                window.location = "/dashboard/perfil.html"
            } else if (resposta.status == 404) {
                window.alert("Deu 404!");
            } else {
                throw ("Houve um erro ao tentar realizar a postagem! Código da resposta: " + resposta.status);
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
    }
</script>